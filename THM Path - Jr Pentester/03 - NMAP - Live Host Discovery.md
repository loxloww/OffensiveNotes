Tool
- nmap
- arp-scan
- masscan


1. Which systems are up?
2. What services are running on these systems?

Nmap approaches :
- ARP scan - link layer
- ICMP scan - Network layer
- TCP/UDP scan - Transport layer

NMAP ROADPLAN :
- Enumerate targets
- Discover live hosts
- Reverse DNS lookup
- Scan ports
- Detect version
- Detect Os
- Traceroute
- Scripts
- Write output

subnet mask
- /24 -> 254 hosts
- /16 -> 65k hosts

if in the same network
- we can use ARP scan

nmap enumeration
```bash
#scan file
nmap -iL file.txt
```

#### ARP scan
```bash
#-PR option + need to be root
#to discover live host on the same network
#-sn to not scan port
sudo nmap -PR -sn IP
```

Traffic :
- Sent : ARP request sent brodcast
- reponse : if ARP response -> host is live, else no

specific tool 
- arp-scan
```bash
arp-scan -l
#on specific interface
arp-scan -I eth0 -l
arp-scan 10.10.210.6/24


```

#### ICMP

structure :
- sent : ICMP echo request (8)
- response : ICMP echo response (0)

```bash
#option for forcing ping scan : -PE
nmap -PE -sn IP
```

ICMP echo tend to be blocked, other method : 
- ICMP Timestamp :
	- structure :
		- ICMP type 13 : timestamp request
		- ICMP type 14 : timestamp reply
```bash
#ICMP timestamp option : -PP
nmap -PP -sn IP
```
- ICMP Address mask
	- structure :
		- ICMP type 17 : address mask request
		- ICMP type 18 : address mask reply
```bash
#ICMP address mask option : -PM
nmap -PM -sn IP
```
#### TCP / UDP

- 3 way handshake :
	- TCP SYN packet sent
	- TCP SYN/ACK packet receive
	- TCP ACK sent
	- Connection established

###### TCP SYN Ping

Use the 3 way handshake
2 mode :
- no root user : complete all the handshake
- root user : dont need to established the connection:
	- SYN -> SYN/ACK -> RST paquet sent
```bash
nmap -PS -sn IP
```

###### TCP ACK Ping

skip the 2 first step of handshake :
- send ACK paquet
- target confuse send RST paquet = means host is up
```bash
nmap -PA -sn IP
```

###### UDP Ping

```bash
nmap -PU -sn IP
```

###### Masscan

more aggressive option

```bash
apt install masscan

masscan P/24 -p443
masscan IP/24 -p80,443
masscan IP/24 -p22-25`
masscan IP/24 ‐‐top-ports 100
```
#### Reverse DNS lookup

```bash
#to skip reverse dns resolution : -n
```